(this["webpackJsonpstoryswap-frontend"]=this["webpackJsonpstoryswap-frontend"]||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},122:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},155:function(e,t,n){},156:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(39),s=n.n(c),i=(n(82),n(4)),o=n.n(i),u=n(8),l=n(2),d=n(12),b=(n(90),n(91),n(7)),j=n(5),f=n(9),h=(n(92),n(93),n(0)),O=["className","children","size"],p=function(e){var t=e.className,n=e.children,a=e.size,r=Object(f.a)(e,O);return Object(h.jsx)("div",Object(j.a)(Object(j.a)({className:"icon icon--".concat(a," ").concat(t),style:{fontSize:a}},r),{},{children:n}))};p.defaultProps={size:"base",className:""};var v=["children","size","icon","reverse","variant","disabled","onClick","loading"],m=function(e){var t=e.children,n=e.size,a=e.icon,r=e.reverse,c=e.variant,s=e.disabled,i=e.onClick,o=e.loading,u=Object(f.a)(e,v);function l(){s||o||i()}return Object(h.jsxs)("button",Object(j.a)(Object(j.a)({className:"button ".concat(c?"button--variant-".concat(c):""," ").concat(n?"button--".concat(n):""," ").concat(o?"button--loading":""),disabled:s,onClick:function(){return l()}},u),{},{children:[a&&!r?Object(h.jsx)(p,{size:n,children:a}):null,Object(h.jsx)("span",{className:"button__text",children:t}),a&&r?Object(h.jsx)(p,{size:n,children:a}):null]}))};m.defaultProps={size:"base",icon:null,reverse:!1,loading:!1,variant:"primary",onClick:void 0};var x=n.p+"static/media/happy.f85563a9.png",g=function(e){Object.assign({},e);var t=Object(d.b)(),n=t.loginWithRedirect,r=t.isAuthenticated,c=t.getAccessTokenSilently,s=t.isLoading,i=Object(b.g)();return Object(a.useEffect)((function(){r&&c().then((function(){return i("/home")}))}),[r]),Object(h.jsxs)("div",{className:"login-view",children:[Object(h.jsxs)("div",{className:"login-view__intro",children:[Object(h.jsx)("img",{src:x,alt:"Happy person with a cup",className:"login-view__person"}),s&&Object(h.jsxs)("div",{children:[Object(h.jsxs)("h1",{className:"headline",children:[Object(h.jsx)("span",{className:"animate-spin",children:"\u23f3"})," Logge ein"]}),Object(h.jsx)("p",{children:"Wir haben einen fr\xfcheren Login erkannt und loggen dich erneut ein."})]}),!s&&!r&&Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"login-view__title",children:[Object(h.jsx)("div",{className:"animation-wink",children:"\ud83d\udc4b"}),Object(h.jsx)("h1",{className:"headline",children:"Willkommen!"})]}),Object(h.jsx)("p",{children:"Nur noch ein Login trennt dich und deine zuk\xfcnftigen Lieblingsb\xfccher \ud83d\udcda."})]})]}),!s&&!r&&Object(h.jsx)(m,{size:"xl",onClick:function(){n()},children:"Anmelden / Registrieren"})]})},w=n(25),k=(n(95),r.a.createContext());function y(e,t){switch(t.type){case"setMetadata":return Object(j.a)({},t.payload);case"deleteMetadata":return{};default:throw new Error("Unhandled action type: ".concat(t.type))}}function _(e){var t=e.children,n=r.a.useReducer(y,{}),a=Object(l.a)(n,2),c={metadataState:a[0],metadataDispatch:a[1]};return Object(h.jsx)(k.Provider,{value:c,children:t})}function N(){var e=r.a.useContext(k);if(void 0===e)throw new Error("useMetadata must be used within a MetadataProvider");return e}var S=r.a.createContext();function C(e,t){switch(t.type){case"setReceiver":return Object(j.a)({},t.payload);case"resetReceiver":return{};default:throw new Error("Unhandled action type: ".concat(t.type))}}function z(e){var t=e.children,n=r.a.useReducer(C,{}),a=Object(l.a)(n,2),c={receiverState:a[0],receiverDispatch:a[1]};return Object(h.jsx)(S.Provider,{value:c,children:t})}function E(){var e=r.a.useContext(S);if(void 0===e)throw new Error("useReceiver must be used within a ReceiverProvider");return e}var L=n(11),P=r.a.createContext();function T(e,t){switch(t.type){case"setApiToken":return{value:t.payload};case"deleteApiToken":return{value:void 0};default:throw new Error("Unhandled action type: ".concat(t.type))}}function I(e){var t=e.children,n=r.a.useReducer(T,null),a=Object(l.a)(n,2),c={apiTokenState:a[0],apiTokenDispatch:a[1]};return Object(h.jsx)(P.Provider,{value:c,children:t})}function F(){var e=r.a.useContext(P);if(void 0===e)throw new Error("useApiToken must be used within a ApiTokenProvider");return e}n(96),n(97);var A=["className","children","paddingoff","clean"],M=function(e){var t=e.className,n=e.children,a=e.paddingoff,r=e.clean,c=Object(f.a)(e,A);return Object(h.jsx)("div",Object(j.a)(Object(j.a)({className:" ".concat(r?"card--clean":"card"," ").concat(a?"":"card--padding"," ").concat(t)},c),{},{children:n}))};M.defaultProps={className:"",paddingoff:!1,clean:!1};n(98),n(99);var D=["children","htmlFor","variant","size","uppercase","className"],U=function(e){var t=e.children,n=e.htmlFor,a=e.variant,r=e.size,c=e.uppercase,s=e.className,i=Object(f.a)(e,D);return Object(h.jsx)("label",Object(j.a)(Object(j.a)({htmlFor:n,className:["label",a?"label--variant-".concat(a):"",r?"label--size-".concat(r):"",c?"label--uppercase":"","".concat(s||"")].join(" ")},i),{},{children:t||"label"}))};U.defaultProps={variant:"highlight",size:"base",uppercase:!0,className:"",htmlFor:""};var R=["label","type","value","placeholder","error","onChange","disabled"],B=function(e){var t=e.label,n=e.type,a=e.value,r=e.placeholder,c=e.error,s=e.onChange,i=e.disabled,o=Object(f.a)(e,R);return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"input ".concat(""!==c?"input--error":"")},o),{},{children:[""!==t&&Object(h.jsx)(U,{size:"xs",variant:"base",className:"input__label",htmlFor:t||"input-id",children:t}),Object(h.jsx)("input",{disabled:i,id:t||"input-id",className:"input__input",type:n,placeholder:r,onChange:function(e){return s(e.target.value)},value:a}),""!==c&&Object(h.jsx)("p",{className:"input__error",children:c})]}))};B.defaultProps={label:"",type:"text",placeholder:"",error:"",onChange:void 0,disabled:!1};var V=n(20),Z=["onFilter","initFilters"],Q=function(e){var t=e.onFilter,n=e.initFilters,r=Object(f.a)(e,Z),c=Object(a.useState)(!1),s=Object(l.a)(c,2),i=s[0],o=s[1],u=Object(a.useState)({}),d=Object(l.a)(u,2),b=d[0],O=d[1],p=Object(a.useState)({}),v=Object(l.a)(p,2),x=v[0],g=v[1],w=Object(a.useState)(!1),k=Object(l.a)(w,2),y=k[0],_=k[1];function N(e){var t=Object.assign({},b),n=Object.keys(e)[0];""===e[n]&&t[n]&&delete t[n];var a=""===e[n]?t:Object(j.a)(Object(j.a)({},t),e);O(a)}return Object(a.useEffect)((function(){!y&&n&&(O(n),_(!0))}),[n]),Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"filter"},r),{},{children:[!i&&Object(h.jsx)("div",{className:"filter__open__btn",children:Object(h.jsx)(m,{variant:"secondary",onClick:function(){o((function(e){return!e}))},children:Object(h.jsxs)("div",{className:"filter__open__btn__content",children:[Object.keys(b).length>0&&Object(h.jsx)("div",{className:"filter__badge",children:Object.keys(b).length}),"Filter"]})})}),i&&Object(h.jsxs)(M,{className:"filter__content",children:[Object(h.jsx)(B,{onChange:function(e){return N({zip:e.toLowerCase()})},label:"Postleitzahl",value:b.zip?b.zip:"",error:x.zip?x.zip:""}),Object(h.jsx)(B,{onChange:function(e){return N({city:e.toLowerCase()})},label:"Stadt",value:b.city?b.city:""}),Object(h.jsx)(m,{onClick:function(){g({});var e=b.isbn&&!Object(V.isValideIsbnOrIsbn13)(b.isbn),n=b.zip&&!Object(V.isValidZip)(b.zip);e&&g((function(e){return Object(j.a)(Object(j.a)({},e),{isbn:"Ung\xfcltige ISBN"})})),n&&g((function(e){return Object(j.a)(Object(j.a)({},e),{zip:"Ung\xfcltige Postleitzahl - 5 Zahlen erfordert"})})),e||n||(t(b),o(!1))},children:"Filtern"}),Object(h.jsx)(m,{size:"sm",variant:"text",onClick:function(){g({}),O(n),t(n)},children:"zur\xfccksetzen"}),Object(h.jsx)(m,{variant:"secondary",onClick:function(){o((function(e){return!e}))},children:"schliessen"})]})]}))};Q.defaultProps={onFilter:void 0,initFilters:{}};n(100),n(101);var J=["paddingoff"],W=function(e){var t=e.paddingoff,n=Object(f.a)(e,J);return Object(h.jsx)("div",Object(j.a)(Object(j.a)({className:"modal ".concat(n.className?n.className:"")},n),{},{children:Object(h.jsx)(M,{paddingoff:t,className:"modal__card",children:n.children})}))};W.defaultProps={paddingoff:!1};n(102);var Y=n(16),H=["unit","min","max","initValue","onChange","disabled"],K=function(e){var t=e.unit,n=e.min,r=e.max,c=(e.initValue,e.onChange),s=e.disabled,i=Object(f.a)(e,H),o=Object(a.useState)(n||1),u=Object(l.a)(o,2),d=u[0],b=u[1];function O(){return"".concat(t?" ".concat(t):d>1?" Tage":" Tag")}return Object(a.useEffect)((function(){c(d)}),[d]),Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"stepper ".concat(i.className)},i),{},{children:[Object(h.jsx)("button",{"aria-label":"increase ".concat(O()),className:"stepper__control ".concat(s?"stepper__control--disabled":""),onClick:function(){d>n&&b((function(e){return e-1}))},disabled:s,children:Object(h.jsx)(Y.h,{})}),Object(h.jsxs)("span",{className:"stepper__value",children:[d,O()]}),Object(h.jsx)("button",{"aria-label":"decrease ".concat(O()),className:"stepper__control ".concat(s?"stepper__control--disabled":""),onClick:function(){d<r&&b((function(e){return e+1}))},disabled:s,children:Object(h.jsx)(Y.a,{})})]}))};K.defaultProps={onChange:void 0,min:1,max:3,unit:"",disabled:!1};n(103);var G=["variant","fullwidth"],$=function(e){var t=e.variant,n=e.fullwidth,a=Object(f.a)(e,G);return Object(h.jsx)("div",Object(j.a)(Object(j.a)({className:"badge badge--".concat(t," ").concat(n?"badge--fullwidth":"")},a),{},{children:a.children}))};$.defaultProps={variant:"medium",fullwidth:!1};var X=n(30),q=n.n(X),ee=n(69),te=(n(122),["center","marker"]);q.a.workerClass=ee.a,q.a.accessToken="pk.eyJ1Ijoic3Rvcnlzd2FwIiwiYSI6ImNreDY2ZDIwZzFjOG0ybnFrY3RxdnlzcXYifQ.ru0CSywnUSPkYbzvVhaykA";var ne=function(e){var t=e.center,n=e.marker,r=Object(f.a)(e,te),c=Object(a.useRef)(null),s=[13.409642496568159,52.52081512666537],i=Object(a.useState)(t[0]||s[0]),o=Object(l.a)(i,2),u=o[0],d=o[1],b=Object(a.useState)(t[1]||s[1]),O=Object(l.a)(b,2),p=O[0],v=O[1];return Object(a.useEffect)((function(){var e=new q.a.Map({container:c.current,style:"mapbox://styles/mapbox/streets-v11",center:[u,p],zoom:13,boxZoom:!1,scrollZoom:!1});if(n){var t=document.createElement("div");t.className="map__marker",new q.a.Marker(t).setLngLat([u,p]).addTo(e)}return e.on("move",(function(){d(e.getCenter().lng.toFixed(4)),v(e.getCenter().lat.toFixed(4))})),function(){return e.remove()}}),[]),Object(h.jsx)("div",Object(j.a)({className:"map-container",ref:c},r))};ne.defaultProps={center:[],marker:!0};var ae=n.p+"static/media/book_small.b83dff1f.jpg",re=["offer","onReserveUntil","onUnreserve","onContactProvider","reserved","clean"],ce=function(e){var t=e.offer,n=e.onReserveUntil,r=e.onUnreserve,c=e.onContactProvider,s=e.reserved,i=e.clean,o=Object(f.a)(e,re),u=Object(a.useState)(!1),d=Object(l.a)(u,2),b=d[0],O=d[1],p=Object(a.useState)(!1),v=Object(l.a)(p,2),x=v[0],g=v[1],w=Object(a.useState)(1),k=Object(l.a)(w,2),y=k[0],_=k[1],N=Object(a.useState)(!1),S=Object(l.a)(N,2),C=S[0],z=S[1],E=Object(a.useState)(!1),L=Object(l.a)(E,2),P=L[0],T=L[1];function I(){O((function(e){return!e}))}function F(){g((function(e){return!e}))}return Object(a.useEffect)((function(){s?(g(!1),z(!1)):T(!1)}),[s]),Object(h.jsxs)(h.Fragment,{children:[x&&!s&&Object(h.jsx)(W,{children:Object(h.jsxs)("div",{className:"offer__reservation-modal",children:[Object(h.jsx)("h1",{className:"offer__reservation__title",children:"Reservierung"}),Object(h.jsx)(K,{onChange:function(e){_(e)},disabled:C}),Object(h.jsx)(m,{onClick:function(){var e=Object(V.addDaysToToday)(y);n({id:t._id,until:e}),z(!0)},loading:C,children:"reservieren"}),Object(h.jsx)(m,{variant:"secondary",onClick:F,disabled:C,children:"zur\xfcck"})]})}),Object(h.jsxs)(M,Object(j.a)(Object(j.a)({clean:i,className:"offer ".concat(o.className?o.className:"")},o),{},{children:[Object(h.jsxs)("div",{className:"offer__header",children:[Object(h.jsx)("div",{className:"offer__title",children:t.book.title}),Object(h.jsxs)("div",{className:"offer__author",children:["VON ",t.book.authors.join(" & ")]})]}),!b&&Object(h.jsx)("div",{className:"offer__cover",role:"img",style:{backgroundImage:"url(".concat(t.book.image?t.book.image:ae,")")},onClick:I}),b&&Object(h.jsxs)("div",{className:"offer__details",children:[Object(h.jsx)("div",{className:"offer__map",children:Object(h.jsx)(ne,{center:t.coordinates})}),!s&&Object(h.jsx)(m,{size:"xl",onClick:F,children:"reservieren"}),s&&Object(h.jsx)(m,{size:"xl",variant:"secondary",loading:P,onClick:function(){T(!0),r({id:t._id})},children:"reservierung stornieren"}),Object(h.jsx)(m,{variant:"secondary",onClick:function(){c(t.provider)},disabled:P,children:"anbieter kontaktieren"}),Object(h.jsx)(m,{variant:"secondary",onClick:I,disabled:P,children:"zur\xfcck"})]}),s&&!b&&Object(h.jsx)("div",{className:"offer__reserved-badge",children:Object(h.jsx)($,{variant:"primary",fullwidth:!0,children:"Reserviert"})}),Object(h.jsx)("div",{className:"offer__divider"}),Object(h.jsxs)("div",{className:"offer__user",children:[Object(h.jsx)("div",{className:"offer__user__picture",role:"img",style:{backgroundImage:"url(".concat(t.provider.picture,")")}}),Object(h.jsx)("div",{className:"offer__user__nickname",children:t.provider.nickname}),Object(h.jsx)("div",{className:"offer__created-at",children:function(e){var t=new Date(e),n=t.getDate(),a=["Januar","Februar","M\xe4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"][t.getMonth()],r=t.getFullYear();return"".concat(n,". ").concat(a," ").concat(r)}(t.createdAt)}),Object(h.jsx)("div",{className:"offer__zip",children:t.zip}),Object(h.jsx)("div",{className:"offer__city",children:t.city})]})]}))]})};ce.defaultProps={offer:{},onReserveUntil:void 0,onContactProvider:void 0,reserved:!1,onUnreserve:void 0,clean:!1};var se=n(70),ie=n.n(se).a.create({baseURL:"/api/",timeout:1e3}),oe=function(e){if(!e)throw new Error("Token is required.");if("string"!==typeof e)throw new TypeError("Invalid token");return{Authorization:"Bearer ".concat(e)}},ue={getMetadata:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.get("user/metadata",{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),setMetadata:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)){e.next=4;break}throw new TypeError("invalid metadata");case 4:return e.next=6,ie.patch("user/metadata",n,{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),setUser:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)){e.next=4;break}throw new TypeError("invalid user");case 4:return e.next=6,ie.patch("user",n,{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),sendPasswordChangeMail:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.post("user/password",{},{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),deleteAccount:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.delete("user",{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},le={getOffersWithFilter:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)){e.next=4;break}throw new TypeError("invalid filter");case 4:return e.next=6,ie.post("offers/filter",n,{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),getMyOffers:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.get("offers/my",{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),reserveOffer:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)&&n.id&&n.until){e.next=4;break}throw new TypeError("invalid options");case 4:return e.next=6,ie.post("offers/".concat(n.id,"/reserve"),{until:n.until},{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),unreserveOffer:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"string"===typeof n){e.next=4;break}throw new TypeError("invalid offer id");case 4:return e.next=6,ie.post("offers/".concat(n,"/unreserve"),{},{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),wasPickedup:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=oe(t),e.next=4,ie.post("offers/".concat(n,"/pickedup"),{},{headers:a});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),create:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)&&n.book&&n.zip&&n.city){e.next=4;break}throw new TypeError("invalid options");case 4:return e.next=6,ie.post("offers/",n,{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),delete:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"string"===typeof n){e.next=4;break}throw new TypeError("invalid offer id");case 4:return e.next=6,ie.delete("offers/".concat(n),{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},de={getMyReservations:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.get("reservations",{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),wasPickedup:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=oe(t),e.next=4,ie.post("reservations/".concat(n,"/pickedup"),{},{headers:a});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}()},be={checkIsbn:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),!(!n||"string"!==typeof n||n.length<9||n.length>13)){e.next=4;break}throw new TypeError("invalid isbn");case 4:return r={isbn:n,isbn13:n},n.length>10?delete r.isbn:delete r.isbn13,e.next=8,ie.post("books",r,{headers:a});case 8:if(200!==(c=e.sent).status){e.next=11;break}return e.abrupt("return",c.data);case 11:return e.abrupt("return",!1);case 14:throw e.prev=14,e.t0=e.catch(0),new Error(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}()},je={getMyChats:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=oe(t),e.next=4,ie.get("chats/my",{headers:n});case 4:return a=e.sent,e.abrupt("return",a.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),getById:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"string"===typeof n){e.next=4;break}throw new TypeError("invalid chatId");case 4:return e.next=6,ie.get("chats/".concat(n),{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),getByReceiverUserSub:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"string"===typeof n){e.next=4;break}throw new TypeError("invalid receiverSub");case 4:return e.next=6,ie.get("chats/sub/".concat(n),{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}(),getMessages:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=oe(t),e.next=4,ie.get("/chats/".concat(n,"/messages"),{headers:a});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),getMessagesAfterMessageId:function(){var e=Object(u.a)(o.a.mark((function e(t,n,a){var r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=oe(t),e.next=4,ie.get("/chats/".concat(n,"/messages/").concat(a),{headers:r});case 4:return c=e.sent,e.abrupt("return",c.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,a){return e.apply(this,arguments)}}(),getLastMessage:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=oe(t),e.next=4,ie.get("/chats/".concat(n,"/last-message"),{headers:a});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:throw e.prev=8,e.t0=e.catch(0),new Error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),create:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)&&n.sub&&n.nickname&&n.picture){e.next=4;break}throw new TypeError("invalid receiver");case 4:return e.next=6,ie.post("chats/",{receiver:n},{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},fe={create:function(){var e=Object(u.a)(o.a.mark((function e(t,n){var a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=oe(t),n&&"object"===typeof n&&!Array.isArray(n)&&n.content&&n.chat){e.next=4;break}throw new TypeError("invalid options");case 4:return e.next=6,ie.post("messages/",n,{headers:a});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e.catch(0),new Error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},he=n.p+"static/media/searching.f736b1d7.png",Oe=n.p+"static/media/sad.35de7dca.png",pe=function(e){Object.assign({},e);var t=F().apiTokenState,n=N().metadataState,r=E().receiverDispatch,c=Object(b.g)(),s=Object(a.useState)(),i=Object(l.a)(s,2),o=i[0],u=i[1],d=Object(a.useState)([]),j=Object(l.a)(d,2),f=j[0],O=j[1],p=Object(a.useState)(null),v=Object(l.a)(p,2),x=v[0],g=v[1],k=Object(a.useState)({}),y=Object(l.a)(k,2),_=y[0],S=y[1],C=Object(a.useState)(!1),z=Object(l.a)(C,2),P=z[0],T=z[1],I=Object(a.useState)(!1),A=Object(l.a)(I,2),M=A[0],D=A[1],U=Object(a.useState)(0),R=Object(l.a)(U,2),B=R[0],V=R[1],Z=Object(a.useState)(null),J=Object(l.a)(Z,2),W=J[0],Y=J[1],H=Object(L.useMutation)((function(e){return le.getOffersWithFilter(t.value,e)})),K=Object(L.useMutation)((function(e){return le.reserveOffer(t.value,e)})),G=Object(L.useMutation)((function(e){return le.unreserveOffer(t.value,e)}));function $(e){r({type:"setReceiver",payload:e}),c("/messages/sub/".concat(e.sub))}function X(e){var t={id:e.id,until:e.until};Y(t),K.mutate(t)}function q(e){G.mutate(e.id)}return Object(a.useEffect)((function(){if(n&&n.city||n&&n.zip){var e={city:n.city,zip:n.zip};u(e),S({filter:e}),H.mutate({filter:e})}}),[n]),Object(a.useEffect)((function(){if(!H.isLoading&&H.isSuccess&&H.data){var e=H.data;e.length>0&&(g(e[e.length-1]._id),O((function(t){return[].concat(Object(w.a)(t),Object(w.a)(e))})),window.scrollTo(0,B),P&&T(!1),e.length<10&&D(!0))}}),[H.isLoading]),Object(a.useEffect)((function(){if(!K.isLoading&&K.isSuccess){var e=f.map((function(e){return e._id===W.id&&(e.reserved=!0),e}));O(e)}}),[K.isLoading]),Object(a.useEffect)((function(){if(!G.isLoading&&G.isSuccess){var e=f.map((function(e){return e._id===W.id&&(e.reserved=!1),e}));O(e)}}),[G.isLoading]),Object(h.jsxs)("div",{className:"home-view",children:[o&&Object(h.jsx)(Q,{onFilter:function(e){O([]),S({filter:e}),D(!1),H.mutate({filter:e})},initFilters:o}),H.isLoading&&0===f.length&&Object(h.jsxs)("div",{className:"home-view__loading",children:[Object(h.jsx)("img",{src:he,alt:"Person seraches for offers on a Laptop"}),Object(h.jsx)("p",{children:"Suche nach Inseraten"})]}),0===f.length&&H.isSuccess&&!H.isLoading&&Object(h.jsxs)("div",{className:"home-view__loading",children:[Object(h.jsx)("img",{src:Oe,alt:"Sad person"}),Object(h.jsx)("p",{children:"Wir konnten leider keine Inserate finden. Du kannst die Suchfilter \xe4ndern, um mehr Angebote zu finden oder erstelle ein Inserat."}),Object(h.jsx)(m,{onClick:function(){c("/library/create-offer")},children:"Erstelle ein Inserat"})]}),!H.isLoading&&f&&f.map((function(e){return Object(h.jsx)(ce,{offer:e,onContactProvider:$,onReserveUntil:X,onUnreserve:q,reserved:e.reserved},e._id)})),!H.isLoading&&f.length>0&&!M&&Object(h.jsx)(m,{loading:P,onClick:function(){T(!0);var e=window.pageYOffset;V(e);var t={filter:_.filter,lastFetchedOfferId:x};S(t),H.mutate({filter:t,lastFetchedOfferId:x})},children:"Weitere laden"})]})},ve=(n(140),n(141),["items","variant","onChange","preselected","disabled"]),me=function(e){var t=e.items,n=e.variant,r=e.onChange,c=e.preselected,s=e.disabled,i=Object(f.a)(e,ve),o=t.length>0&&c?c:"",u=Object(a.useState)(o),d=Object(l.a)(u,2),b=d[0],O=d[1];return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"select"},i),{},{children:[0===t.length&&Object(h.jsx)("span",{children:"No Items given"}),Object(h.jsx)(h.Fragment,{children:t.map((function(e,t){return Object(h.jsx)(m,{disabled:s,size:"full",variant:"".concat(e.label)===b?n:"secondary",icon:e.icon?e.icon:null,reverse:e.reverse,onClick:function(){return function(e){O(e.label),e.label!==b&&r(e.label)}(e)},style:{transition:"background-color 300ms ease-in"},children:e.label},"".concat(e.label,"-").concat(t))}))})]}))};me.defaultProps={disabled:!1,items:[],variant:"accent",preselected:"",onChange:void 0};var xe=n.p+"static/media/smilling.3f48dd85.png",ge=function(e){Object.assign({},e);var t=Object(b.g)(),n=Object(d.b)().logout,r=F().apiTokenState,c=Object(a.useState)(""),s=Object(l.a)(c,2),i=s[0],j=s[1],f=Object(a.useState)(""),O=Object(l.a)(f,2),p=O[0],v=O[1],x=Object(a.useState)(""),g=Object(l.a)(x,2),w=g[0],k=g[1],y=Object(a.useState)(""),_=Object(l.a)(y,2),S=_[0],C=_[1],z=Object(a.useState)(""),E=Object(l.a)(z,2),P=E[0],T=E[1],I=Object(a.useState)(""),A=Object(l.a)(I,2),M=A[0],D=A[1],U=Object(a.useState)(!1),R=Object(l.a)(U,2),Z=R[0],Q=R[1],J=[{label:"Ja"},{label:"Nein"}],W=Object(a.useState)(!1),Y=Object(l.a)(W,2),H=Y[0],K=Y[1],G=Object(a.useState)(null),$=Object(l.a)(G,2),X=$[0],q=$[1],ee=Object(a.useState)(!1),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],re=Object(a.useState)(!1),ce=Object(l.a)(re,2),se=ce[0],ie=ce[1],oe=N().metadataDispatch,le=Object(L.useQuery)("metadata",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.setMetadata(null===r||void 0===r?void 0:r.value,X);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{enabled:ne}),de=le.isLoading,be=le.data,je=Object(L.useQuery)("nickname",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.setUser(null===r||void 0===r?void 0:r.value,{nickname:i});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{enabled:se}),fe=je.isLoading,he=je.data;function Oe(e){return!(!e||e.length<3||e>30)}function pe(e){return!(!e||i.length<2)}return Object(a.useEffect)((function(){!de&&be&&!fe&&he&&(ae(!1),ie(!1),K(!0))}),[de,be,fe,he]),Object(h.jsxs)("div",{className:"onboarding-view",children:[!H&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("section",{className:"onboarding-view__section",children:[Object(h.jsx)("h1",{className:"headline",children:"Dein Name"}),Object(h.jsx)("p",{children:"Unter welchen Namen sollen dich die anderen Nutzer und Nutzerinnen sehen \ud83d\udc40 k\xf6nnen?"}),Object(h.jsx)(B,{label:"Anzeigename",placeholder:"Anzeigename",value:i,onChange:function(e){j(e)},error:p,type:"text",disabled:ne||se})]}),Object(h.jsxs)("section",{className:"onboarding-view__section",children:[Object(h.jsx)("h1",{className:"headline",children:"Dein Einzugsgebiet"}),Object(h.jsx)("p",{children:"In welchen Gebiet \ud83d\uddfa sollen wir f\xfcr dich nach B\xfcchern suchen \ud83d\udd0e?"}),Object(h.jsx)(B,{disabled:ne||se,label:"Stadt",placeholder:"Stadt",value:w,onChange:function(e){k(e)},error:S,type:"text"}),Object(h.jsx)(B,{disabled:ne||se,label:"Postleitzahl",placeholder:"Postleitzahl",value:P,onChange:function(e){T(e)},error:M,type:"text"})]}),Object(h.jsxs)("section",{className:"onboarding-view__section",children:[Object(h.jsx)("h1",{className:"headline",children:"B\xfccher verleihen"}),Object(h.jsx)("p",{children:"W\xe4re es f\xfcr dich in Zukunft eine Option einige deiner Lieblingsst\xfccke \u2665 zu verleihen?"}),Object(h.jsx)(me,{disabled:ne||se,items:J,preselected:J[1].label,variant:"accent",onChange:function(e){Q("Ja"===e)}})]}),Object(h.jsxs)("section",{className:"onboarding-view__section onboarding-view__section--gap-4 mt-4",children:[Object(h.jsx)(m,{loading:ne||se,size:"xl",onClick:function(){if(v(""),C(""),D(""),!Object(V.isValidZip)(P)||!Oe(i)||!pe)return Object(V.isValidZip)(P)||D("Keine zul\xe4ssige Postleitzahl."),Oe(i)||v("Der Anzeigename muss zwischen 6 und 30 Zeichen lang sein."),void(pe(w)||C("Die Stadt muss mindestens drei Zeichen lang sein."));q({city:w,zip:P,rental:Z,isOnboarded:!0}),ae(!0),ie(!0)},children:"Speichern & Loslegen"}),Object(h.jsx)(m,{disabled:ne||se,variant:"secondary",onClick:function(){n({returnTo:window.location.origin})},children:"Abbrechen & Ausloggen"})]})]}),H&&Object(h.jsxs)("section",{className:"onboarding-view__section onboarding-view__section--gap-4",children:[Object(h.jsx)("img",{src:xe,alt:"Happy person with a cup",className:"onboarding-view__person"}),Object(h.jsxs)("h1",{className:"headline",children:["Super ",i,"!"]}),Object(h.jsx)("p",{children:"Alles ist eingerichtet \ud83c\udf89! Schnapp dir eine Tasse Kaffee \u2615, Tee oder dein Lieblingsgetr\xe4nk deiner Wahl und begebe dich auf die Suche \ud83d\udd0e nach deinem n\xe4chsten Lieblingsbuch \ud83d\udcd6."}),Object(h.jsx)(m,{size:"xl",onClick:function(){oe({type:"setMetadata",payload:be}),t("/home")},children:"Loslegen"})]})]})},we=(n(142),n(143),n(144),["onClick","alt","imageUrl","variant","label"]),ke=function(e){var t=e.onClick,n=e.alt,a=e.imageUrl,r=e.variant,c=e.label,s=Object(f.a)(e,we);return Object(h.jsx)(M,{children:Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"book-card",onClick:t},s),{},{children:[Object(h.jsx)("img",{src:a,alt:n,className:"book-card__cover"}),Object(h.jsx)($,{fullwidth:!0,variant:r,children:c})]}))})};ke.defaultProps={onClick:void 0,variant:"medium"};var ye=function(e){var t=e.reservation,n=e.onContactProvider,r=e.onUnreserve,c=e.onPickedUp,s=new Date,i=new Date(t.until).getTime()-s.getTime(),o=Math.round(i/864e5),u=Object(a.useState)(!1),d=Object(l.a)(u,2),b=d[0],j=d[1],f=Object(a.useState)(!1),O=Object(l.a)(f,2),p=O[0],v=O[1],x=Object(a.useState)(!1),g=Object(l.a)(x,2),w=g[0],k=g[1],y="Noch ".concat(o," ").concat(o>1?"Tage":"Tag");function _(){j((function(e){return!e}))}return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(ke,{onClick:_,imageUrl:t.offer.book.image?t.offer.book.image:ae,variant:o<=1?"accent":"medium",alt:t.offer.book.title,label:y}),b&&Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(W,{paddingoff:!0,children:[Object(h.jsx)(ce,{offer:t.offer,reserved:!0,clean:!0,onUnreserve:function(){v(!0),r(t.offer._id),j(!1)},onContactProvider:function(){n(t.offer.provider)}}),Object(h.jsxs)("div",{className:"reservation-card__modal",children:[Object(h.jsx)(m,{loading:w,onClick:function(){k(!0),c(t._id)},children:"Buch wurde abgeholt"}),Object(h.jsx)(m,{variant:"secondary",disabled:p||w,onClick:_,children:"schlie\xdfen"})]})]})})]})};ye.defaultProps={reservation:{},onContactProvider:void 0,onUnreserve:void 0,onPickedUp:void 0};n(145),n(146);var _e=["user"],Ne=function(e){var t=e.user,n=Object(f.a)(e,_e);return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"user"},n),{},{children:[Object(h.jsx)("img",{src:t.picture,alt:t.nickname,className:"user__picture"}),Object(h.jsx)("span",{className:"user__nickname",children:t.nickname})]}))};Ne.defaultProps={user:{sub:"",nickname:"",picture:""}};var Se=function(e){var t,n=e.offer,r=e.onContactCollector,c=e.onDelete,s=e.onPickedUp,i=Object(a.useState)(!1),o=Object(l.a)(i,2),u=o[0],d=o[1],b=Object(a.useState)(!1),j=Object(l.a)(b,2),f=j[0],O=j[1],p=Object(a.useState)(!1),v=Object(l.a)(p,2),x=v[0],g=v[1],w=new Date,k=new Date(n.reservation?n.reservation.until:"").getTime()-w.getTime(),y=Math.round(k/864e5);function _(){d((function(e){return!e}))}function N(e){return"pending"===e?"offen":"pickedup"===e?"abgeholt":"reserviert"}return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(ke,{onClick:_,imageUrl:n.book.image?n.book.image:ae,variant:(t=n.state,"pending"===t?"medium":"pickedup"===t?"primary":"accent"),alt:n.book.title,label:N(n.state)}),u&&Object(h.jsx)(W,{children:Object(h.jsxs)("div",{className:"offer-card__modal",children:[Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{className:"offer-card__book-title",children:n.book.title}),Object(h.jsx)("p",{className:"offer-card__book-author",children:n.book.authors.join(" & ")})]}),Object(h.jsx)("div",{children:Object(h.jsxs)("p",{className:"offer-card__zip-city",children:["Abzuholen in ",n.zip," ",n.city]})}),Object(h.jsx)(m,{variant:"text",onClick:function(){g(!0),c(n._id)},loading:x,children:"Inserat l\xf6schen"}),(null===n||void 0===n?void 0:n.reservation)&&"reserved"===n.state&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"offer-card__divider"}),Object(h.jsx)(Ne,{user:n.reservation.collector}),Object(h.jsx)($,{fullwidth:!0,children:"".concat(y," ").concat(y>1?"Tage":"Tag"," ").concat(N(n.state)," ")}),Object(h.jsxs)(m,{disabled:f,variant:"secondary",onClick:function(){r(n.reservation.collector)},children:[n.reservation.collector.nickname," kontaktieren"]}),Object(h.jsx)("div",{className:"offer-card__divider"})]}),(null===n||void 0===n?void 0:n.reservation)&&Object(h.jsx)(m,{loading:f,onClick:function(){O(!0),s(n._id)},children:"Buch wurde abgeholt"}),Object(h.jsx)(m,{disabled:f||x,variant:"secondary",onClick:_,children:"schlie\xdfen"})]})})]})};Se.defaultProps={onContactCollector:void 0,onPickedUp:void 0,onDelete:void 0};var Ce=n.p+"static/media/calm.f9e39bab.png",ze=function(e){Object.assign({},e);var t=F().apiTokenState,n=N().metadataState,r=E().receiverDispatch,c=Object(b.g)(),s=Object(b.h)().init,i=Object(a.useState)(!1),d=Object(l.a)(i,2),j=d[0],f=d[1],O=[{label:"reserviert"},{label:"inseriert"}],p=Object(a.useState)(O[0].label),v=Object(l.a)(p,2),x=v[0],g=v[1],k=Object(a.useState)(null),y=Object(l.a)(k,2),_=y[0],S=y[1],C=Object(a.useState)([]),z=Object(l.a)(C,2),P=z[0],T=z[1],I=Object(a.useState)([]),A=Object(l.a)(I,2),M=A[0],D=A[1],U=Object(a.useState)(null),R=Object(l.a)(U,2),V=R[0],Z=R[1],Q=Object(a.useState)(null),J=Object(l.a)(Q,2),Y=J[0],H=J[1],K=Object(a.useState)(""),G=Object(l.a)(K,2),$=G[0],X=G[1],q=Object(a.useState)(""),ee=Object(l.a)(q,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),re=Object(l.a)(ae,2),ce=re[0],se=re[1],ie=Object(a.useState)(!1),oe=Object(l.a)(ie,2),ue=oe[0],je=oe[1],fe=Object(a.useState)(null),he=Object(l.a)(fe,2),Oe=he[0],pe=he[1],ve=Object(L.useQuery)("reservations",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.getMyReservations(t.value);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),ge=Object(L.useQuery)("offers",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getMyOffers(t.value);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),we=Object(L.useMutation)((function(e){return le.unreserveOffer(t.value,e)})),ke=Object(L.useMutation)((function(e){return de.wasPickedup(t.value,e)})),_e=Object(L.useMutation)((function(e){return le.wasPickedup(t.value,e)})),Ne=Object(L.useMutation)((function(e){return be.checkIsbn(t.value,e)})),ze=Object(L.useMutation)((function(e){return le.delete(t.value,e)})),Ee=Object(L.useMutation)((function(e){return le.create(t.value,e)}));function Le(e){S(e),we.mutate(e)}function Pe(e){H(e),_e.mutate(e)}function Te(e){Z(e),ke.mutate(e)}function Ie(e){r({type:"setReceiver",payload:e}),c("/messages/sub/".concat(e.sub))}function Fe(e){pe(e),ze.mutate(e)}return Object(a.useEffect)((function(){"create-offer"===s&&(f(!0),je(!1))}),[]),Object(a.useEffect)((function(){!ve.isFetching&&ve.isSuccess&&ve.data.length>0&&T(ve.data)}),[ve.isFetching]),Object(a.useEffect)((function(){ge.isSuccess&&ge.data.length>0&&D(ge.data)}),[ge.isLoading]),Object(a.useEffect)((function(){if(!we.isLoading&&we.isSuccess){var e=P.filter((function(e){return e.offer._id!==_}));T(e)}}),[we.isLoading]),Object(a.useEffect)((function(){if(!ke.isLoading&&ke.isSuccess){var e=P.filter((function(e){return e._id!==V}));T(e)}}),[ke.isLoading]),Object(a.useEffect)((function(){if(!_e.isLoading&&_e.isSuccess){var e=M.filter((function(e){return e._id!==Y}));D(e)}}),[_e.isLoading]),Object(a.useEffect)((function(){!Ne.isLoading&&Ne.isSuccess&&Ne.data&&se(Ne.data)}),[Ne.isLoading]),Object(a.useEffect)((function(){!Ee.isLoading&&Ee.isSuccess&&je(!0)}),[Ee.isLoading]),Object(a.useEffect)((function(){if(!ze.isLoading&&ze.isSuccess){var e=M.filter((function(e){return e._id!==Oe}));D(e),pe(null)}}),[ze.isLoading]),Object(h.jsxs)("div",{className:"library-view",children:[Object(h.jsx)(me,{items:O,preselected:O[0].label,onChange:function(e){g(e)}}),"reserviert"===x&&Object(h.jsxs)("div",{className:"library-view__reserved",children:[0===P.length&&Object(h.jsxs)("div",{className:"library-view__message",children:[Object(h.jsx)("img",{src:Ce,alt:"Calm person with a coffe cup"}),Object(h.jsx)("p",{children:"Du hast keine Reservierungen derzeitig. Schau doch mal nach ob du nicht vielleicht ein neues Lieblingsbuch endeckst\ud83d\udd75\ufe0f\u200d\u2642\ufe0f !"}),Object(h.jsx)(m,{onClick:function(){c("/home")},children:"Zu den Inseraten"})]}),Object(h.jsx)("div",{className:"library-view__reserved__offers",children:P.length>0&&P.map((function(e){return Object(h.jsx)(ye,{onContactProvider:Ie,reservation:e,onUnreserve:Le,onPickedUp:Te},e._id)}))})]}),"inseriert"===x&&Object(h.jsxs)("div",{className:"library-view__offers",children:[M.length>0&&Object(h.jsx)("div",{className:"library-view__offers__myOffers",children:M.map((function(e){return Object(h.jsx)(Se,{offer:e,onContactCollector:Ie,onPickedUp:Pe,onDelete:Fe},e._id)}))}),0===M.length&&Object(h.jsxs)("div",{className:"library-view__message",children:[Object(h.jsx)("img",{src:Ce,alt:"Calm person with a coffe cup"}),Object(h.jsx)("p",{children:"Du hast noch kein Inserat eingestellt. Erstelle eins um anderen Nutzer und Nutzerinnen die M\xf6glichkeit zu geben Ihr neues Lieblignsbuch \u2764\ufe0f zu finden."})]}),Object(h.jsx)(m,{onClick:function(){f(!0),je(!1)},children:"Inserat erstellen"})]}),j&&Object(h.jsx)(W,{children:Object(h.jsxs)("div",{className:"library-view__create-offer-modal",children:[!ce&&!ue&&Object(h.jsxs)("div",{className:"flex flex-col gap-4",children:[Object(h.jsx)("h1",{className:"headline text-center",children:"Neues Inserat \ud83d\udcda "}),Object(h.jsx)("p",{className:"text-center",children:"Um ein neues Inserat anzulegen, gebe einfach die ISBN oder ISBN13 des Buches ein. Wir werden anschlie\xdfend alle notwendigen Informationen zusammentragen und automatisch \ud83e\udd16 f\xfcr dich erg\xe4nzen."}),Object(h.jsx)(B,{value:$,onChange:function(e){X(e)},label:"ISBN oder ISBN13",type:"text",disabled:!1,error:te}),Ne.isSuccess&&!Ne.data&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("p",{className:"animate-bounce text-center text-2xl",children:"\ud83d\udc7b"}),Object(h.jsx)("p",{className:"text-center text-red-500",children:"Ops! Leider konnten wir dein Buch nicht in unserer Datenbank finden. Dies ist meistens der Fall, wenn das Buch gerade erschienen ist. Probiere es in einigen Tagen nochmal."})]}),Object(h.jsx)(m,{size:"xl",loading:Ne.isLoading,onClick:function(){ne(""),$.length<9||$.length>10&&$.length<13||$.length>13?ne("Die ISBN muss 9,10 oder 13 stellig sein."):Ne.mutate($)},children:"\xdcberpr\xfcfe ISBN"})]}),ce&&!ue&&Object(h.jsxs)("div",{className:"flex flex-col gap-4",children:[Object(h.jsx)("h2",{className:"headline",children:ce.title}),Object(h.jsxs)("p",{className:"offer__author",children:["VON ",ce.authors.join(" & ")]}),Object(h.jsx)("img",{src:ce.image,alt:ce.title,className:"rounded"}),Object(h.jsxs)("p",{className:"font-bold text-center",children:["Angeboten in ",n.zip,", ",n.city]}),Object(h.jsx)(m,{size:"xl",onClick:function(){var e={book:ce._id,zip:parseInt(n.zip),city:n.city};Ee.mutate(e)},children:"erstellen"}),Object(h.jsx)(m,{variant:"secondary",onClick:function(){se(null)},children:"zur\xfcck"})]}),!ue&&Object(h.jsx)(m,{variant:"secondary",disabled:Ne.isLoading,onClick:function(){f(!1),je(!1)},children:"abbrechen"}),ue&&Object(h.jsxs)("div",{className:"library-view__message",children:[Object(h.jsx)("img",{src:xe,alt:"Happy person with a coffe cup"}),Object(h.jsx)("p",{className:"text-center",children:"Dein Buch \ud83d\udcd6 wurde erfolgreich inseriert und ist nun f\xfcr andere Nutzer und Nutzerinnen sichtbar \ud83c\udf89."}),Object(h.jsx)(m,{onClick:function(){var e=Ee.data;e.book=ce;var t=[].concat(Object(w.a)(M),[e]);D(t),je(!1),se(null),f(!1)},children:"zur\xfcck zu meinen Inseraten"})]})]})})]})},Ee=(n(147),n.p+"static/media/unhappy.eb31c42a.png"),Le=function(e){Object.assign({},e);var t=Object(d.b)().user,n=F().apiTokenState,r=Object(a.useState)(""),c=Object(l.a)(r,2),s=c[0],i=c[1],j=Object(a.useState)([]),f=Object(l.a)(j,2),O=f[0],p=f[1],v=Object(b.g)(),x=E().receiverDispatch,g=Object(L.useQuery)("chats",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",je.getMyChats(n.value));case 1:case"end":return e.stop()}}),e)}))));return Object(a.useEffect)((function(){!g.isLoading&&g.isSuccess&&g.data&&p(g.data)}),[g.isLoading]),Object(h.jsxs)("div",{className:"messages-view",children:[O.length>0&&Object(h.jsx)(B,{value:s,onChange:function(e){i(e)},type:"text",placeholder:"Suchen"}),!g.isLoading&&0===O.length&&Object(h.jsxs)("div",{className:"messages-view__no-chats",children:[Object(h.jsx)("img",{src:Ee,alt:"Unhappy person"}),Object(h.jsx)("p",{children:"Du hast leider noch niemanden kontaktiert. Schau doch mal in die Inserate, ob du etwas findest was dich interessiert. Reserviere und kontaktiere dann den Anbieter, um dein neus Lieblingsbuch \ud83d\udcd6 abholen zu k\xf6nnen."}),Object(h.jsx)(m,{onClick:function(){v("/home")},children:"zu den inseraten"})]}),!g.isLoading&&g.isSuccess&&g.data.length>0&&Object(h.jsx)("div",{className:"messages-view__chats",children:O.filter((function(e){return e.users[0].sub===t.sub?e.users[1].nickname.toLowerCase().includes(s.toLowerCase()):e.users[0].nickname.toLowerCase().includes(s.toLowerCase())})).map((function(e){return Object(h.jsx)("div",{className:"messages-view__chat",onClick:function(){return n=e.users[0].sub===t.sub?e.users[1]:e.users[0],x({type:"setReceiver",payload:n}),void v("/messages/sub/".concat(n.sub));var n},children:Object(h.jsx)(Ne,{user:e.users[0].sub===t.sub?e.users[1]:e.users[0]})},e._id)}))})]})},Pe=(n(148),n(149),["onCreate","sending"]),Te=function(e){var t=e.onCreate,n=e.sending,r=Object(f.a)(e,Pe),c=Object(a.useState)(""),s=Object(l.a)(c,2),i=s[0],o=s[1],u=Object(a.useState)(!1),d=Object(l.a)(u,2),b=d[0],O=d[1];return Object(a.useEffect)((function(){n||b||O(!0),n&&b&&(o(""),O(!1))}),[n]),Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"create-message ".concat(""!==i?"create-message--grid":"")},r),{},{children:[Object(h.jsx)(B,{type:"textarea",className:"create-message__input",onChange:function(e){o(e)},value:i,disabled:n}),""!==i&&Object(h.jsx)(m,{loading:n,size:"full",onClick:function(){t(i)},children:Object(h.jsx)(Y.f,{className:"create-message__icon ".concat(n?"create-message__icon--sending":"")})})]}))};Te.defualtProps={onCreate:void 0,sending:!1};n(150);var Ie=["message","timestamp","creator"],Fe=function(e){var t=e.message,n=e.timestamp,a=e.creator,r=Object(f.a)(e,Ie);return Object(h.jsx)("div",{className:"message ".concat(a?"message--justify-end":"message--justify-start"),children:Object(h.jsxs)(M,Object(j.a)(Object(j.a)({className:"message__card ".concat(a?"message--primary":"")},r),{},{children:[Object(h.jsx)("p",{className:"message__content",children:t}),Object(h.jsx)("p",{className:"message__timestamp",children:n})]}))})};Fe.defaultProps={message:"",created:"",creator:!1};var Ae,Me=function(e){Object.assign({},e);var t=Object(d.b)().user,n=F().apiTokenState,r=Object(a.useState)(null),c=Object(l.a)(r,2),s=c[0],i=c[1],j=Object(b.h)().sub,f=Object(b.g)(),O=Object(a.useState)(null),p=Object(l.a)(O,2),v=p[0],x=p[1],g=Object(a.useState)(!1),k=Object(l.a)(g,2),y=k[0],_=k[1],N=Object(a.useState)(!1),S=Object(l.a)(N,2),C=S[0],z=S[1],P=Object(a.useState)([]),T=Object(l.a)(P,2),I=T[0],A=T[1],M=Object(a.useState)(!1),D=Object(l.a)(M,2),U=D[0],R=D[1],B=Object(a.useState)(!1),V=Object(l.a)(B,2),Z=V[0],Q=V[1],J=Object(a.useRef)(null),W=E(),H=W.receiverState,K=W.receiverDispatch,G=Object(L.useQuery)("chat-sub-".concat(j),Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",je.getByReceiverUserSub(s,j));case 1:case"end":return e.stop()}}),e)}))),{enabled:C}),$=Object(L.useQuery)("chat-messages-".concat(U),Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",je.getMessages(s,U));case 1:case"end":return e.stop()}}),e)}))),{enabled:!!U}),X=Object(L.useMutation)((function(e){return fe.create(s,e)})),q=Object(L.useMutation)((function(e){return je.create(s,e)}),{enabled:!!s});return Object(a.useEffect)((function(){n.value&&i(n.value)}),[n.value]),Object(a.useEffect)((function(){j&&z(!0)}),[]),Object(a.useEffect)((function(){G.isFetching||G.isLoading||!G.isSuccess||(G.data?(x(G.data),R(G.data._id)):_(!0))}),[G.isLoading]),Object(a.useEffect)((function(){!$.isFetching&&!$.isLoading&&$.isSuccess&&$.data&&A($.data.reverse())}),[$.isLoading,$.isFetching]),Object(a.useEffect)((function(){if(!X.isLoading&&X.isSuccess&&X.data){var e=X.data;A((function(t){return[].concat(Object(w.a)(t),[e])})),Q(!1)}}),[X.isLoading]),Object(a.useEffect)((function(){q.isFetching||q.isLoading||!q.isSuccess||(x(q.data),R(q.data._id),K({type:"resetReceiver"}),_(!1))}),[q.isLoading]),Object(a.useEffect)((function(){!function(){var e;null===(e=J.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[I]),Object(a.useEffect)((function(){y&&q.mutate(H)}),[y]),Object(h.jsx)("div",{className:"chat-view",children:!y&&v&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"chat-view__header",children:[Object(h.jsx)(m,{variant:"secondary",size:"xl",onClick:function(){f(-1)},children:Object(h.jsx)(Y.b,{})}),Object(h.jsx)(Ne,{user:v.users[0].sub===t.sub?v.users[1]:v.users[0]})]}),I&&Object(h.jsxs)("div",{className:"chat-view__messages",children:[I.map((function(e){return Object(h.jsx)(Fe,{message:e.content,timestamp:e.created_at,creator:e.creatorSub===t.sub},e._id)})),Object(h.jsx)("div",{ref:J})]},"chat-".concat(v._id,"-messages")),Object(h.jsx)("div",{className:"chat-view__write-input",children:Object(h.jsx)(Te,{onCreate:function(e){Q(!0),X.mutate({content:e,chat:v._id})},sending:Z})})]})})},De=(n(151),function(e){Object.assign({},e);var t=Object(d.b)(),n=t.logout,r=t.user,c=F().apiTokenState,s=Object(a.useState)(!1),i=Object(l.a)(s,2),o=i[0],u=i[1],b=Object(a.useState)(!1),j=Object(l.a)(b,2),f=j[0],O=j[1],p=Object(a.useState)(!1),v=Object(l.a)(p,2),x=v[0],g=v[1],w=Object(a.useState)(!1),k=Object(l.a)(w,2),y=k[0],_=k[1],N=Object(a.useState)(!1),S=Object(l.a)(N,2),C=S[0],z=S[1],E=Object(a.useState)({name:r.name,nickname:r.nickname,email:r.email,picture:r.picture}),P=Object(l.a)(E,2),T=P[0],I=P[1],A=Object(a.useState)(r.name),M=Object(l.a)(A,2),D=M[0],U=M[1],R=Object(a.useState)(r.nickname),Z=Object(l.a)(R,2),Q=Z[0],J=Z[1],Y=Object(a.useState)(r.email),H=Object(l.a)(Y,2),K=H[0],G=H[1],$=Object(a.useState)(""),X=Object(l.a)($,2),q=X[0],ee=X[1],te=Object(a.useState)(r.picture),ne=Object(l.a)(te,2),ae=ne[0],re=ne[1],ce=Object(L.useMutation)((function(){return ue.sendPasswordChangeMail(c.value)})),se=Object(L.useMutation)((function(e){return ue.setUser(c.value,e)})),ie=Object(L.useMutation)((function(){return ue.deleteAccount(c.value)}),{enabled:f});function oe(){u((function(e){return!e}))}return Object(a.useEffect)((function(){ce.isLoading||ce.isFetching||!ce.isSuccess||(_(!1),g(!0))}),[ce.isLoading]),Object(a.useEffect)((function(){ie.isLoading||ie.isFetching||!ie.isSuccess||(Object(V.deletePageCookies)(),localStorage.clear(),sessionStorage.clear(),n())}),[ce.isLoading,ie.isSuccess]),Object(a.useEffect)((function(){I({name:D,nickname:Q,email:K,picture:ae})}),[D,Q,K,ae]),Object(h.jsxs)("div",{className:"settings-view",children:[Object(h.jsx)("h1",{className:"headline text-center",children:"Einstellungen"}),Object(h.jsx)("img",{src:r.picture,alt:r.name,className:"settings-view__user__image"}),Object(h.jsx)(B,{label:"Name",type:"text",value:D,disabled:!C,onChange:function(e){U(e)}}),Object(h.jsx)(B,{label:"Benutzername",type:"text",value:Q,disabled:!C,onChange:function(e){J(e)}}),Object(h.jsx)(B,{label:"e-mail",type:"mail",value:K,disabled:!C,onChange:function(e){ee(Object(V.isValidEmail)(e)?"":"Ung\xfcltige eMail."),G(e)},error:q}),Object(h.jsx)(B,{label:"Profilbild Link",type:"text",value:ae,disabled:!C,onChange:function(e){re(e)}}),Object(h.jsx)(m,{size:"lg",onClick:function(){n({returnTo:window.location.origin})},children:"ausloggen"}),C&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("p",{className:"text-xs text-medium-900 text-center",children:"Profilbilder werden erst nach einer erneuten Anmeldung angezeigt."}),Object(h.jsx)(m,{size:"lg",variant:"primary",onClick:function(){se.mutate(T),z(!1)},loading:se.isLoading||se.isFetching,children:"speichern"}),Object(h.jsx)(m,{size:"lg",variant:"secondary",onClick:function(){J(r.nickname),G(r.email),U(r.name),re(r.picture),z(!1)},disabled:se.isLoading||se.isFetching,children:"abbruch"})]}),!C&&Object(h.jsx)(m,{size:"lg",variant:"secondary",onClick:function(){z(!0)},children:"Profil editieren"}),Object(h.jsx)(m,{size:"lg",variant:"secondary",onClick:function(){ce.mutate(),_(!0)},loading:y,children:"passwort \xe4ndern"}),x&&!y&&Object(h.jsx)("p",{className:"text-center",children:"Du hast eine e-Mail erhalten, mit der du dein Passwort \xe4ndern kannst."}),Object(h.jsx)(m,{size:"xs",variant:"text",onClick:oe,children:"Account l\xf6schen"}),o&&Object(h.jsx)(W,{children:Object(h.jsxs)("div",{className:"settings-view__delte-modal ",children:[Object(h.jsx)("h1",{className:"headline",children:"Konto l\xf6schen"}),Object(h.jsx)("img",{src:Oe,alt:"Sad Person"}),Object(h.jsx)("p",{children:"Oh nein \ud83d\ude33, schade das du uns verlassen m\xf6chtest. Bist du dir sicher das du dein Konto l\xf6schen m\xf6chtest?"}),Object(h.jsx)("div",{className:"py-4",children:Object(h.jsx)(m,{loading:f,size:"sm",variant:"text",onClick:function(){O(!0),ie.mutate()},children:"Ja mein Konto l\xf6schen"})}),Object(h.jsx)(m,{disabled:f,size:"xl",onClick:oe,children:"abbrechen"})]})})]})}),Ue=function(e){var t=e.children,n=Object(d.b)().isAuthenticated,a=Object(b.f)();return n?t:Object(h.jsx)(b.a,{to:"/login",state:{from:a}})},Re=(n(152),n(71)),Be=n.n(Re),Ve=["title","titleId"];function Ze(){return Ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Ze.apply(this,arguments)}function Qe(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Je(e,t){var n=e.title,r=e.titleId,c=Qe(e,Ve);return a.createElement("svg",Ze({width:14,height:14,viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":r},c),n?a.createElement("title",{id:r},n):null,Ae||(Ae=a.createElement("path",{d:"M13.5 0V12.0103C13.5 12.9058 12.4597 13.3714 11.8198 12.7622L7.39014 8.54548C6.99235 8.16682 6.37276 8.18272 5.99393 8.5813L2.216 12.5562C1.58979 13.2151 0.5 12.7603 0.5 11.8401V0H13.5Z",fill:"#4AAF91"})))}var We=a.forwardRef(Je),Ye=(n.p,n(155),["onClick","variant","selected"]),He=function(e){var t=e.onClick,n=e.variant,a=e.selected,r=Object(f.a)(e,Ye);return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"navSlot ".concat(r.className?r.className:"")},r),{},{onClick:function(){a||t(n)},children:[Object(h.jsx)(We,{className:"navSlot__flag ".concat(a?"navSlot__flag--selected":"navSlot__flag--not-selected")}),Object(h.jsx)(p,{className:"navSlot__icon ".concat(a?"navSlot__icon--selected":""),children:function(e){switch(e){case"home":default:return Object(h.jsx)(Y.d,{});case"library":return Object(h.jsx)(Y.c,{});case"messages":return Object(h.jsx)(Y.e,{});case"settings":return Object(h.jsx)(Y.g,{})}}(n)})]}))};He.defaultsProps={variant:"home",selected:!1,onClick:Be.a.undefined};var Ke=["onSelect","select"],Ge=function(e){var t=e.onSelect,n=e.select,a=Object(f.a)(e,Ke);return Object(h.jsxs)("div",Object(j.a)(Object(j.a)({className:"navigation"},a),{},{children:[Object(h.jsx)(He,{onClick:t,selected:"home"===n,variant:"home"}),Object(h.jsx)(He,{onClick:t,selected:"library"===n,variant:"library"}),Object(h.jsx)(He,{onClick:t,selected:"messages"===n,variant:"messages"}),Object(h.jsx)(He,{onClick:t,selected:"settings"===n,variant:"settings"})]}))};Ge.defaultProps={select:"home",onSelect:void 0};var $e=function(){var e=Object(d.b)(),t=e.isAuthenticated,n=e.getAccessTokenSilently,r=N(),c=(r.metadataState,r.metadataDispatch),s=F(),i=s.apiTokenState,j=s.apiTokenDispatch,f=Object(b.f)(),O=Object(a.useState)("home"),p=Object(l.a)(O,2),v=p[0],m=p[1],x=Object(a.useState)(!1),w=Object(l.a)(x,2),k=w[0],y=w[1],_=Object(b.g)(),S=Object(L.useQuery)("metadata",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.getMetadata(null===i||void 0===i?void 0:i.value);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),{enabled:k}),C=S.isLoading,z=S.isSuccess,E=S.data;return Object(a.useEffect)((function(){!C&&z&&(c({type:"setMetadata",payload:E}),y(!1),E&&!E.isOnboarded&&_("/onboarding"))}),[C,E]),Object(a.useEffect)((function(){t&&n().then((function(e){j({type:"setApiToken",payload:e}),y(!0)}))}),[t]),Object(a.useEffect)((function(){f.pathname.includes("messages")&&m("messages"),f.pathname.includes("home")&&m("home")}),[f.pathname]),Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)("div",{className:"App__content",children:Object(h.jsxs)(b.d,{children:[Object(h.jsx)(b.b,{path:"/login",element:Object(h.jsx)(g,{})}),Object(h.jsx)(b.b,{path:"/onboarding",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(ge,{})})}),Object(h.jsx)(b.b,{path:"/home",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(pe,{})})}),Object(h.jsx)(b.b,{path:"/library/:init",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(ze,{})})}),Object(h.jsx)(b.b,{path:"/library",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(ze,{})})}),Object(h.jsx)(b.b,{path:"/messages/sub/:sub",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(Me,{})})}),Object(h.jsx)(b.b,{path:"/messages",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(Le,{})})}),Object(h.jsx)(b.b,{path:"/settings",element:Object(h.jsx)(Ue,{children:Object(h.jsx)(De,{})})}),Object(h.jsx)(b.b,{path:"*",element:Object(h.jsx)(g,{})})]})}),t&&"/onboarding"!==f.pathname&&Object(h.jsx)("div",{className:"App__navigation",children:Object(h.jsx)(Ge,{onSelect:function(e){m(e),_("/".concat(e))},select:v})})]})},Xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,159)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))},qe=n(17),et=new L.QueryClient;s.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(d.a,{domain:"storyswap.eu.auth0.com",clientId:"K02ZmIC9PSnGHfX3uG165VenI5OBOOQI",redirectUri:window.location.origin,audience:"https://api.storyswap.app",scope:"openid profile email",children:Object(h.jsx)(I,{children:Object(h.jsx)(L.QueryClientProvider,{client:et,children:Object(h.jsx)(_,{children:Object(h.jsx)(z,{children:Object(h.jsx)(qe.a,{children:Object(h.jsx)($e,{})})})})})})})}),document.getElementById("root")),Xe()},20:function(e,t){e.exports.isValideIsbnOrIsbn13=function(e){if(!e||"string"!==typeof e)return!1;if(e.length<9||e.length>13)return!1;return!!/^[0-9-]*$/.test(e)},e.exports.isValidZip=function(e){if(!e||"string"!==typeof e)return!1;return!!/^\d{5}$/.test(e)},e.exports.addDaysToToday=function(e){var t=new Date;return t.setHours(23,59,59,0),t.setDate(t.getDate()+e),t},e.exports.isValidEmail=function(e){if(!e||"string"!==typeof e)return!1;return/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(e)},e.exports.deletePageCookies=function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var n=e[t],a=n.indexOf("="),r=a>-1?n.substr(0,a):n;document.cookie=r+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}},82:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[156,1,2]]]);
//# sourceMappingURL=main.1d42cc29.chunk.js.map